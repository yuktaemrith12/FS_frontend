<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MDX After Class</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Vue 2 -->
  <script src="https://unpkg.com/vue@2.7.14/dist/vue.min.js"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="app">
    <!-- ===== Global Header / Nav ===== -->
    <nav class="site-nav">
      <div class="nav-left">
        <span class="brand"><i class="fa-solid fa-graduation-cap"></i> MDX After Class</span>
      </div>
      <ul class="nav-right">
        <li><a href="#" :class="{active:view==='home'}" @click.prevent="go('home')">Home</a></li>
        <li><a href="#" :class="{active:view==='lessons'}" @click.prevent="go('lessons')">Book Now</a></li>
        <li>
          <!-- Cart pill (toggle) -->
          <button
            class="cart-pill"
            :disabled="view !== 'cart' && cart.length === 0"
            @click="view === 'cart' ? go('lessons') : go('cart')"
            :aria-label="view === 'cart' ? 'Back to lessons' : 'Open cart'"
            :title="view === 'cart' ? 'Back to lessons' : 'Open cart'"
          >
            <i class="fa-solid fa-cart-shopping"></i>
            <span class="count" v-if="cart.length">{{ cart.length }}</span>
            <span class="label">{{ view === 'cart' ? 'Back' : 'Cart' }}</span>
          </button>

        </li>
      </ul>
    </nav>

    <!-- ===== HOME VIEW (hero + tutors) ===== -->
<!-- ===== HOME VIEW (hero) ===== -->
    <main v-if="view==='home'" class="home">
        <section class="hero">
            <!-- LEFT: image -->
            <div class="hero-art">
            <img src="assets/start.png" alt="Student illustration">
            </div>

            <!-- RIGHT: title + description -->
            <div class="hero-copy">
            <h1>Learn Beyond Classrooms</h1>
            <p>
                Discover fun and engaging after-school activities designed to build
                new skills, spark creativity, and help students grow to the next level.
            </p>
            <div class="hero-actions">
                <a href="#tutors" class="btn hollow">Our Tutors</a>
                <button class="btn primary" @click="go('lessons')">Book Now</button>
            </div>
            </div>
        </section>

      <!-- Tutors -->
        <section id="tutors" class="tutors">
        <h2>Our Tutors</h2>
        <div class="tutor-grid">

            <article class="tutor-card">
            <div class="avatar"><img src="assets/professors/prof4.jpg" alt=""></div>
            <h3>Dr. Sarah Johnson</h3>
            <p>PhD in Mathematics, 12+ years teaching experience. Specialist in algebra, calculus, and preparing students for competitive exams.</p>
            </article>

            <article class="tutor-card">
            <div class="avatar"><img src="assets/professors/prof2.jpg" alt=""></div>
            <h3>Mrs. Danila Smith</h3>
            <p>MSc in Computer Science, former software engineer. 8+ years teaching coding, web development, and robotics to high school and university students.</p>
            </article>

            <article class="tutor-card">
            <div class="avatar"><img src="assets/professors/prof3.jpg" alt=""></div>
            <h3>Ms. Aisha Patel</h3>
            <p>BA in English Literature, 10 years tutoring experience. Focused on creative writing, public speaking, and helping learners build confidence in communication.</p>
            </article>

            <article class="tutor-card">
            <div class="avatar"><img src="assets/professors/prof1.jpg" alt=""></div>
            <h3>Mr. Kevin Lee</h3>
            <p>MFA in Music Education, professional pianist. 15 years experience in teaching piano, music theory, and leading school orchestras.</p>
            </article>

        </div>

        <div class="tutors-cta">
            <button class="btn primary lg" @click="go('lessons')">Book Now</button>
        </div>
        </section>

    </main>

    <!-- ===== LESSONS VIEW ===== -->
    <main v-if="view==='lessons'" class="container">
      <!-- Toolbar (sort + search) -->
      <header class="toolbar">
        <div class="muted small">Sort by</div>
        <select v-model="sortBy" aria-label="Sort attribute">
          <option value="topic">Subject</option>
          <option value="location">Location</option>
          <option value="price">Price</option>
          <option value="space">Spaces</option>
        </select>

        <div class="muted small">Order</div>
        <select v-model="sortDir" aria-label="Sort order">
          <option value="asc">Ascending</option>
          <option value="desc">Descending</option>
        </select>

        <input class="search-input" v-model.trim="searchTerm" placeholder="Search subject, location, price, spaces…" />
      </header>

      <p v-if="loading" class="muted">Loading lessons…</p>
      <p v-else-if="sortedLessons.length === 0" class="muted">No results.</p>

      <!-- Product-style grid -->
      <section class="product-grid">
        <article class="product-card" v-for="l in sortedLessons" :key="l._id">
          <div class="pc-media">
            <img :src="l.img || 'assets/placeholder.jpg'" :alt="cap(l.topic)" loading="lazy" />
            <button class="pc-fav" type="button" aria-label="Save">
              <i class="fa-regular fa-heart"></i>
            </button>
          </div>

          <div class="pc-body">
            <h3 class="pc-title">{{ cap(l.topic) }}</h3>

            <!-- Required metadata for coursework -->
            <ul class="pc-meta">
              <li><strong>Location:</strong> {{ l.location }}</li>
              <li><strong>Price:</strong> Rs {{ l.price }}</li>
              <li><strong>Spaces:</strong> {{ l.space }}</li>
            </ul>

            <div class="pc-stars" :aria-label="`Rating ${l.rating}/5`">
              <i v-for="n in 5" :key="n"
                :class="[n<=l.rating ? 'fa-solid' : 'fa-regular','fa-star']"></i>
            </div>

            <button class="btn primary pc-cta"
                    :disabled="l.space<=0"
                    :class="{disabled:l.space<=0}"
                    @click="addToCart(l)">
              {{ l.space>0 ? 'Book Now' : 'Sold Out' }}
            </button>
          </div>
        </article>
      </section>
    </main>


    <!-- ===== CART / CHECKOUT VIEW ===== -->
    <main v-if="view==='cart'" class="container">
      <h2 class="page-title">Your Lesson Cart</h2>

      <section v-if="cart.length" class="cart-grid">
        <!-- LEFT: Table -->
        <article class="card cart-table-wrap">
          <table class="cart-table" aria-label="Selected lessons">
            <thead>
              <tr>
                <th>Lesson</th>
                <th>Location</th>
                <th class="right">Price (Rs)</th>
                <th class="center">Remove</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(l, idx) in cart" :key="idx">
                <td class="cap">{{ l.topic }}</td>
                <td>{{ l.location }}</td>
                <td class="right">{{ l.price }}</td>
                <td class="center">
                  <button class="icon-btn danger" @click="removeFromCart(idx)" aria-label="Remove lesson">
                    <i class="fa-solid fa-xmark"></i>
                  </button>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr class="grand">
                <td colspan="2" class="right">Total</td>
                <td class="right"><strong>Rs {{ cartTotal }}</strong></td>
                <td></td>
              </tr>
            </tfoot>
          </table>

        </article>

        <!-- RIGHT: Modern Checkout -->
        <aside class="card pay-panel">
          <h3>Checkout</h3>

          <div class="pay-method">
            <label class="radio"><input type="radio" name="pm" checked/> <span>Pay on site</span></label>
            <label class="radio"><input type="radio" name="pm" disabled/> <span class="muted">Card (demo)</span></label>
          </div>

          <div class="form compact">
            <label>
              Full Name
              <input v-model="order.name" placeholder="Letters only" />
              <small :class="validName ? 'ok' : 'err'">{{ validName ? '✔ Looks good' : 'Letters only (A–Z, spaces)' }}</small>
            </label>
            <label>
              Phone
              <input v-model="order.phone" placeholder="Numbers only" />
              <small :class="validPhone ? 'ok' : 'err'">{{ validPhone ? '✔ Looks good' : 'Digits only (0–9)' }}</small>
            </label>
          </div>

          <button class="btn primary checkout-btn"
                  :disabled="!canCheckout"
                  @click="openConfirm">
            Check Out
          </button>
          <p v-if="message" class="message">{{ message }}</p>
        </aside>
      </section>

      <p v-else class="muted">Your cart is empty.</p>

      <!-- Confirmation Modal -->
      <div class="modal-mask" v-if="showConfirm" @click.self="showConfirm=false">
        <div class="modal">
          <h3>Order confirmation</h3>
          <p class="muted">You’re about to submit your booking for <strong>{{ cart.length }}</strong> lesson(s), total <strong>Rs {{ cartTotal }}</strong>.</p>
          <div class="modal-actions">
            <button class="btn" @click="showConfirm=false">Cancel</button>
            <button class="btn primary" @click="finalizeCheckout">Confirm & Go Home</button>
          </div>
        </div>
      </div>
    </main>

  </div>

  <!-- Your app code -->
  <script src="app.js"></script>
  
</body>
</html>
